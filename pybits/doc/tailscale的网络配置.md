# TailScale è®¾å¤‡é…ç½®è¡¨

| è®¾å¤‡åç§° | ç”¨æˆ·å | é‚®ç®± | TailScale IP | TailScale ç‰ˆæœ¬ | æ“ä½œç³»ç»Ÿ | è¿æ¥çŠ¶æ€ |
|---------|--------|------|--------------|----------------|----------|----------|
| desktop-3ppqi06 | aolihagong | aolihagong@gmail.com | 100.125.179.75 | 1.90.9 | Windows 11 25H2 | Connected âœ… |
| drxwill | aolihagong | aolihagong@gmail.com | 100.108.28.120 | 1.90.9 | Linux 6.6.87.2-microsoft-standard-WSL2 | Connected âœ… |

---

## ğŸ“Š è®¾å¤‡ä¿¡æ¯åˆ†æ

### å½“å‰çŠ¶æ€
1. **ä¸¤å°è®¾å¤‡å·²æˆåŠŸè¿æ¥åˆ°åŒä¸€TailScaleç½‘ç»œ**
2. **ä¸¤å°è®¾å¤‡å±äºåŒä¸€ç”¨æˆ·** (aolihagong@gmail.com)
3. **ç½‘ç»œè¿é€šæ€§æ­£å¸¸** (å‡æ˜¾ç¤ºConnectedçŠ¶æ€)

### IPåœ°å€åˆ†é…
- **Windowså°å¼æœº**: `100.125.179.75`
- **WSL 2è®¾å¤‡**: `100.108.28.120`

### ç³»ç»Ÿç¯å¢ƒ
| è®¾å¤‡ | ç±»å‹ | ç”¨é€”å»ºè®® |
|------|------|----------|
| desktop-3ppqi06 | Windowså°å¼æœº | å¼€å‘å·¥ä½œç«™ï¼Œè¿è¡ŒVS Code |
| drxwill | WSL 2 (Ubuntu) | é›†ç¾¤èŠ‚ç‚¹ï¼Œè¿è¡ŒDockerå’Œ1Panel |

---

## ğŸ”§ ç½‘ç»œè¿é€šæ€§æµ‹è¯•

### 1. åŸºæœ¬è¿é€šæ€§æµ‹è¯•
```bash
# ä»Windowså°å¼æœºping WSLè®¾å¤‡
ping 100.108.28.120

# ä»WSLè®¾å¤‡ping Windowså°å¼æœº
ping 100.125.179.75
```

### 2. ç«¯å£è¿é€šæ€§æµ‹è¯•
```bash
# æµ‹è¯•SSHç«¯å£ (22)
telnet 100.108.28.120 22

# æµ‹è¯•Docker APIç«¯å£ (2375/2376)
telnet 100.108.28.120 2375
```

### 3. å­ç½‘è·¯ç”±é…ç½®ï¼ˆæ¨èï¼‰
```powershell
# åœ¨Windowsè®¾å¤‡ä¸Šå¯ç”¨å­ç½‘è·¯ç”±ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰
tailscale up --advertise-routes=172.16.0.0/12

# ç„¶ååœ¨TailScaleç®¡ç†åå°æ‰¹å‡†è·¯ç”±
# è®¿é—®ï¼šhttps://login.tailscale.com/admin/machines
# æ‰¾åˆ°desktop-3ppqi06è®¾å¤‡ â†’ Edit route settings â†’ å¯ç”¨å­ç½‘è·¯ç”±
```

---

## ğŸ› ï¸ é…ç½®å»ºè®®

### 1. è®¾å¤‡é‡å‘½åï¼ˆä¾¿äºè¯†åˆ«ï¼‰
```bash
# åœ¨TailScaleç®¡ç†åå°æˆ–ä½¿ç”¨CLI
tailscale set-hostname beijing-desktop  # Windowså°å¼æœº
tailscale set-hostname beijing-wsl      # WSLè®¾å¤‡
```

### 2. è®¿é—®æ§åˆ¶åˆ—è¡¨ (ACL) é…ç½®
```json
// åœ¨TailScaleç®¡ç†åå°çš„ACLé¡µé¢æ·»åŠ 
{
  "acls": [
    // å…è®¸æ‰€æœ‰è®¾å¤‡äº’è®¿
    {"action": "accept", "src": ["*"], "dst": ["*:*"]},
    
    // æˆ–è€…æ›´ç²¾ç»†çš„æ§åˆ¶
    {
      "action": "accept",
      "src": ["tag:desktop"],
      "dst": ["tag:server:22", "tag:server:80", "tag:server:443"]
    }
  ]
}
```

### 3. DNSé…ç½®ï¼ˆå¯é€‰ï¼‰
```bash
# å¯ç”¨MagicDNSï¼ˆä¾¿äºè®°å¿†ï¼‰
# åœ¨TailScaleç®¡ç†åå°ï¼šSettings â†’ DNS â†’ MagicDNS â†’ Enable

# å¯ç”¨åå¯é€šè¿‡ä¸»æœºåè®¿é—®
ping drxwill.tailnet-xxxx.ts.net
```

---

## ğŸ“ åœ¨åˆ†å¸ƒå¼æ–¹æ¡ˆä¸­çš„åº”ç”¨

### å½“å‰è®¾å¤‡æ˜ å°„
| è§’è‰² | è®¾å¤‡ | IPåœ°å€ |
|------|------|--------|
| åŒ—äº¬å°å¼æœºï¼ˆå¼€å‘æœºï¼‰ | desktop-3ppqi06 | 100.125.179.75 |
| åŒ—äº¬ç¬”è®°æœ¬WSLï¼ˆé›†ç¾¤èŠ‚ç‚¹ï¼‰ | drxwill | 100.108.28.120 |
| ä¸Šæµ·å°å¼æœºï¼ˆå¾…æ·»åŠ ï¼‰ | å¾…é…ç½® | å¾…åˆ†é… |
| ä¸Šæµ·ç¬”è®°æœ¬WSLï¼ˆå¾…æ·»åŠ ï¼‰ | å¾…é…ç½® | å¾…åˆ†é… |

### ä¸‹ä¸€æ­¥æ“ä½œ
1. **ä¸Šæµ·æœ‹å‹åŠ å…¥ç½‘ç»œ**ï¼š
   ```bash
   # ä¸Šæµ·è®¾å¤‡å®‰è£…TailScaleå¹¶ä½¿ç”¨åŒä¸€è´¦å·ç™»å½•
   curl -fsSL https://tailscale.com/install.sh | sh
   sudo tailscale up
   ```

2. **é…ç½®å››è®¾å¤‡äº’é€š**ï¼š
   - ç¡®ä¿æ‰€æœ‰è®¾å¤‡èƒ½çœ‹åˆ°å½¼æ­¤
   - æµ‹è¯•åŒå‘pingé€š

3. **è®¾ç½®èŠ‚ç‚¹æ ‡ç­¾**ï¼ˆç”¨äºDocker Swarmï¼‰ï¼š
   ```bash
   # åœ¨åŒ—äº¬WSLè®¾å¤‡
   tailscale set-hostname node-beijing
   
   # åœ¨ä¸Šæµ·WSLè®¾å¤‡ï¼ˆæœªæ¥ï¼‰
   tailscale set-hostname node-shanghai
   ```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å…è´¹ç‰ˆé™åˆ¶**ï¼š
   - æœ€å¤š3ä¸ªç”¨æˆ·
   - æ¯ç”¨æˆ·æœ€å¤š100ä¸ªè®¾å¤‡
   - å½“å‰é…ç½®å®Œå…¨è¶³å¤Ÿ

2. **ç½‘ç»œæ€§èƒ½**ï¼š
   - å¦‚æœè®¾å¤‡é—´å»¶è¿Ÿé«˜ï¼Œè€ƒè™‘å‡çº§åˆ°ä»˜è´¹ç‰ˆä½¿ç”¨è‡ªå®šä¹‰ä¸­ç»§
   - æˆ–è€…è‡ªå»ºHeadscaleæœåŠ¡å™¨

3. **å®‰å…¨æ€§**ï¼š
   - æ‰€æœ‰é€šä¿¡è‡ªåŠ¨åŠ å¯†
   - å»ºè®®è®¾ç½®è®¾å¤‡å®¡æ‰¹ï¼ˆRequire device approvalï¼‰

4. **è¿æ¥ä¿æŒ**ï¼š
   ```bash
   # ç¡®ä¿TailScaleæœåŠ¡è‡ªå¯åŠ¨
   sudo systemctl enable tailscaled
   sudo systemctl start tailscaled
   ```

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜
| é—®é¢˜ | è§£å†³æ–¹æ³• |
|------|----------|
| è®¾å¤‡æ— æ³•pingé€š | æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œæš‚æ—¶å…³é—­æµ‹è¯• |
| è¿æ¥çŠ¶æ€æ˜¾ç¤ºä¸ºRelay | æ£€æŸ¥NATç±»å‹ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨é…ç½®ä¸­ç»§ |
| WSLè®¾å¤‡é‡å¯åIPå˜åŒ– | TailScale IPå›ºå®šä¸å˜ï¼Œä¸å½±å“ä½¿ç”¨ |

### è¯Šæ–­å‘½ä»¤
```bash
# æŸ¥çœ‹è¯¦ç»†è¿æ¥çŠ¶æ€
tailscale status --json

# è¯Šæ–­ç½‘ç»œé—®é¢˜
tailscale netcheck

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u tailscaled -f
```

---

å½“å‰é…ç½®å·²å®Œæˆä¸¤å°è®¾å¤‡çš„ç½‘ç»œæ‰“é€šï¼Œå¯ä»¥ç»§ç»­è¿›è¡ŒDocker Swarmé›†ç¾¤å’Œ1Panelçš„éƒ¨ç½²ã€‚éœ€è¦æ·»åŠ ä¸Šæµ·è®¾å¤‡æ—¶ï¼Œä½¿ç”¨ç›¸åŒçš„TailScaleè´¦å·ç™»å½•å³å¯è‡ªåŠ¨åŠ å…¥ç½‘ç»œã€‚